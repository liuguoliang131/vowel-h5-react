"use strict";(self.webpackChunkreact_template=self.webpackChunkreact_template||[]).push([[833],{9833:function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});var n=o(1413),r=o(4165),s=o(5861),a=o(885),i=o(2791),c=(o(6133),o(3622),o(9642)),u=o(2377),l=o.n(u),h=o(6429),A=o(6871),g=o(4569),d=o.n(g),f=o(184);var m=function(){var e=(0,i.useState)({user_name:"",user_avatar:"",poster_url:""}),t=(0,a.Z)(e,2),u=t[0],g=t[1],m=(0,i.useRef)(),p=(0,i.useRef)(),U=(0,A.TH)(),S=function(e){console.log("blobToBase64 1",e);var t=new FileReader;return t.readAsDataURL(e),new Promise((function(e){t.onload=function(t){e(t.target.result)}}))},w=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var o,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d().get(t,{responseType:"blob"});case 2:return o=e.sent,e.next=5,S(new Blob([o.data],{type:o.headers["content-type"]}));case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.EU)({promotion_id:U.state.id});case 2:if(0===(t=e.sent).code){e.next=5;break}return e.abrupt("return",!1);case 5:return o={posterUrl:"",userAvatar:""},e.next=8,w(t.data.poster_url);case 8:return o.posterUrl=e.sent,e.next=11,w(t.data.user_avatar);case 11:o.userAvatar=e.sent,console.log("resData",o),g((0,n.Z)((0,n.Z)({},t.data),o));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){if(console.log("viewRef",p),m.current&&p.current){var e=m.current,t=p.current;t.width=3*e.offsetWidth,t.height=3*e.offsetHeight;var o=375,n=517,r={x:0,y:0,width:0,height:0};r.x=3*e.offsetWidth*14/o,r.y=3*e.offsetHeight*17/n,r.width=3*e.offsetWidth*32/o,r.height=3*e.offsetWidth*32/o;var s={x:3*e.offsetWidth*50/o,y:3*e.offsetHeight*37/n,fontSize:3*e.offsetHeight*15/n},a={x:3*e.offsetWidth*147/o,y:3*e.offsetHeight*405/n,width:3*e.offsetWidth*82/o,height:3*e.offsetWidth*82/o},i=t.getContext("2d"),c=null;(c=new Image).crossOrigin="anonymous",c.setAttribute("crossOrigin","anonymous");var h=new Image;h.setAttribute("crossOrigin","anonymous"),h.crossOrigin="anonymous";var A=document.createElement("div");A.height=3*a.height,A.width=3*a.width;var g=window.location.protocol+"//"+window.location.host+"/#/layout/home?id=".concat(U.state.id,"&share_sign=").concat(u.share_sign),d=(S=a.width,w=a.height,J=g,k="canvas",Q=A,new(l())(Q,{width:S,height:w,text:J,render:k,correctLevel:1})),f=d._el.querySelector("canvas").toDataURL("image/png");console.log("qrcodeObj src",d._el.children[1]),h.onload=function(){console.log("codeImg.src1",h.src),i.drawImage(h,a.x,a.y,a.width,a.width)},h.onerror=function(e){},c.onerror=function(e){console.log("image error",e)},c.onload=function(){console.log("image"),i.drawImage(c,0,0,3*e.offsetWidth,3*e.offsetHeight),i.font="".concat(s.fontSize,"px PingFang SC"),i.textAlign="left",console.log("title.x, title.y",s.x,s.y),i.fillText(u.user_name,s.x,s.y),h.src=f;var t=new Image;t.crossOrigin="anonymous",t.setAttribute("crossOrigin","anonymous"),t.onload=function(){console.log("ava.x, ava.y, ava.width, ava.height",r.x,r.y,r.width,r.height),i.arc(r.x+r.width/2,r.y+r.height/2,r.width/2,0,2*Math.PI),i.clip(),i.drawImage(t,r.x,r.y,r.width,r.height)},t.src=u.userAvatar,console.log("avaImg src",t.src)},c.src=u.posterUrl,console.log("image.src",c)}var S,w,J,k,Q};return(0,i.useEffect)((function(){return J(),function(){}}),[]),(0,i.useEffect)((function(){k()}),[p,m,u]),(0,f.jsx)("div",{className:"poster",children:u.share_sign?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"poster-box",children:(0,f.jsx)("div",{className:"full",ref:m,children:(0,f.jsx)("canvas",{ref:p})})}),(0,f.jsxs)("div",{className:"bottom-box",children:[(0,f.jsx)("a",{className:"save-the",download:!0,href:"javascript:;",onClick:function(){return function(){try{var e=p.current.toDataURL("image/png;base64");c.Z.ownApp((function(){c.Z.saveBase64Image(e)}),(function(){var t=document.createElement("a");t.download="\u5206\u4eab\u6d77\u62a5",t.href=e,t.click()}))}catch(t){console.log(t),alert(t.message)}}()},children:"\u70b9\u51fb\u4fdd\u5b58\u6d77\u62a5"}),(0,f.jsxs)("div",{className:"bottom-box-share",children:[(0,f.jsx)("div",{className:"share-1",children:"\u53ef\u5206\u4eab\u81f3\u5fae\u4fe1\u6216\u670b\u53cb\u5708"}),(0,f.jsx)("img",{src:o(8621),alt:"",className:"share-2"}),(0,f.jsx)("img",{src:o(2518),alt:"",className:"share-3"})]})]})]}):null})}},2518:function(e){e.exports="data:image/png;base64,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"},8621:function(e){e.exports="data:image/png;base64,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"}}]);
//# sourceMappingURL=833.76930477.chunk.js.map
{"version":3,"file":"static/js/604.30e51b4c.chunk.js","mappings":"4RAiHA,MAvGA,WACEA,QAAQC,IAAI,WACZ,OAAsCC,EAAAA,EAAAA,UAAS,GAA/C,eAAOC,EAAP,KAAoBC,EAApB,KACA,GAAwBF,EAAAA,EAAAA,UAAS,IAAjC,eAAOG,EAAP,KAAaC,EAAb,KACMC,GAAWC,EAAAA,EAAAA,MAmBjB,GAA8BN,EAAAA,EAAAA,WAAS,GAAvC,eAAOO,EAAP,KAAgBC,EAAhB,KAvBkB,8CAwBlB,0GAKoBC,EAAAA,EAAAA,IAAiB,CACjCC,KAAMT,IANV,OAKQU,EALR,OAQET,GAAe,SAAAU,GAAG,OAAIA,EAAM,CAAV,IAClBd,QAAQC,IAAI,MAAOY,GACdA,EAAIR,MAGPC,GAAQ,SAAAQ,GAAG,wBAAQA,IAAR,OAAgBD,EAAIR,MAApB,IACXK,GAAW,IAHXA,GAAW,GAXf,4CAxBkB,sBA0ClB,IAAMK,EAAS,yCAAG,gGAChBX,EAAe,GADC,UAEEO,EAAAA,EAAAA,IAAiB,CACjCC,KAAMT,IAHQ,OAEVU,EAFU,OAKhBT,GAAe,SAAAU,GAAG,OAAIA,EAAM,CAAV,IAClBd,QAAQC,IAAI,MAAOY,GACdA,EAAIR,MAIPC,GAAQ,SAAAQ,GAAG,wBAAQA,IAAR,OAAgBD,EAAIR,MAApB,IACXK,GAAW,KAJXJ,EAAQ,IACRI,GAAW,IATG,2CAAH,qDAef,OACE,iBAAKM,UAAU,UAAf,WACE,SAAC,IAAD,CAASC,KAAK,8BACd,SAAC,KAAD,CACEF,WAAS,uBAAE,4GAAYA,KAAZ,2CADb,UAGA,iBAAKC,UAAU,OAAf,UAEIX,EAAKa,KAAI,SAACC,EAAMC,GAAP,OACP,iBAAKJ,UAAU,OAAmBK,QAAS,kBAvD5B,SAACF,GACxBnB,QAAQC,IAAI,mBAAoBkB,GACZ,IAAhBA,EAAKG,OAEPf,EAAS,eAAgB,CAAEgB,OAAM,UAAMJ,GAAQK,SAAS,IAExDC,EAAAA,GAAAA,KAAW,CACTC,QAAS,kCAGd,CA6C0DC,CAAiBR,EAAvB,EAA3C,WACE,gBAAKH,UAAU,YAAf,SACGG,EAAKS,SAER,gBAAKZ,UAAU,YAAf,SACGG,EAAKU,aAER,iBAAKb,UAAU,YAAf,2CACMG,EAAKW,WADX,IACwBX,EAAKY,aAE7B,iBAAKf,UAAU,YAAf,WACE,gBAAKA,UAAU,cAAf,SAEoB,IAAhBG,EAAKG,QAEL,iBAAMN,UAAU,KAAhB,6CAGA,iBAAMA,UAAU,MAAhB,+CAKJ,gBAAKA,UAAU,cAAcK,QAAS,SAACW,GAAD,OAnF5B,SAACb,EAAMa,GAC7BA,EAAEC,kBACF1B,EAAS,kBAAmB,CAAEgB,OAAM,UAAMJ,GAAQK,SAAS,GAC5D,CAgF0DU,CAAgBf,EAAMa,EAA7B,EAAtC,2CAvBuBZ,EADpB,KA+BX,SAAC,KAAD,CAAgBe,SAhGJ,2CAgGwB1B,QAASA,WAKpD,C","sources":["pages/myEvent/index.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport utils from '../../utils/index'\r\nimport { useNavigate } from 'react-router'\r\nimport Crumbs1 from '../../components/crumbs1'\r\nimport { PullToRefresh, InfiniteScroll, Toast } from 'antd-mobile'\r\nimport { sleep } from 'antd-mobile/es/utils/sleep'\r\nimport { mockRequest } from './mock-request.jsx'\r\nimport './index.scss'\r\nimport { promotionListApi } from '../../axios/api'\r\nconst currentPage = 1\r\nfunction MyEvent () {\r\n  console.log('myevent')\r\n  const [currentPage, setCurrentPage] = useState(1)\r\n  const [data, setData] = useState([])\r\n  const navigate = useNavigate()\r\n  // 查看奖品\r\n  const handleViewPrize = (item, e) => {\r\n    e.stopPropagation()\r\n    navigate('/layout/myPrize', { state: { ...item }, replace: false })\r\n  }\r\n  // 查看活动详情\r\n  const handleViewDetail = (item) => {\r\n    console.log('handleViewDetail', item)\r\n    if (item.status === 1) {\r\n      // utils.hashPush('/layout/home', item)\r\n      navigate('/layout/home', { state: { ...item }, replace: false })\r\n    } else {\r\n      Toast.show({\r\n        content: '活动结束了'\r\n      })\r\n    }\r\n  }\r\n\r\n  const [hasMore, setHasMore] = useState(true)\r\n  async function loadMore () {\r\n    // const append = await mockRequest([\r\n    //   { id: '1', status: 1 },\r\n    //   { id: '2', status: 0 }\r\n    // ])\r\n    const res = await promotionListApi({\r\n      page: currentPage\r\n    })\r\n    setCurrentPage(val => val + 1)\r\n    console.log('res', res)\r\n    if (!res.data) {\r\n      setHasMore(false)\r\n    } else {\r\n      setData(val => [...val, ...res.data])\r\n      setHasMore(true)\r\n    }\r\n  }\r\n  // 下拉刷新\r\n  const onRefresh = async () => {\r\n    setCurrentPage(1)\r\n    const res = await promotionListApi({\r\n      page: currentPage\r\n    })\r\n    setCurrentPage(val => val + 1)\r\n    console.log('res', res)\r\n    if (!res.data) {\r\n      setData([])\r\n      setHasMore(false)\r\n    } else {\r\n      setData(val => [...val, ...res.data])\r\n      setHasMore(true)\r\n    }\r\n  }\r\n  return (\r\n    <div className=\"myEvent\">\r\n      <Crumbs1 text='我的活动'></Crumbs1>\r\n      <PullToRefresh\r\n        onRefresh={async () => onRefresh()}\r\n      >\r\n      <div className=\"list\">\r\n        {\r\n          data.map((item, index) => (\r\n            <div className=\"item\" key={index} onClick={() => handleViewDetail(item)}>\r\n              <div className=\"item-row1\">\r\n                {item.title}\r\n              </div>\r\n              <div className=\"item-row2\">\r\n                {item.sub_title}\r\n              </div>\r\n              <div className=\"item-row3\">\r\n              抢购时间：{item.start_time}-{item.end_time}\r\n              </div>\r\n              <div className=\"item-row4\">\r\n                <div className=\"item-row4-l\">\r\n                  {\r\n                    item.status === 1\r\n                      ? (\r\n                    <span className=\"on\">活动进行中</span>\r\n                        )\r\n                      : (\r\n                    <span className=\"off\">活动已结束</span>\r\n                        )\r\n\r\n                  }\r\n                </div>\r\n                <div className=\"item-row4-r\" onClick={(e) => handleViewPrize(item, e)}>\r\n                  查看奖品\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))\r\n        }\r\n        <InfiniteScroll loadMore={loadMore} hasMore={hasMore} />\r\n      </div>\r\n      </PullToRefresh>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default MyEvent\r\n"],"names":["console","log","useState","currentPage","setCurrentPage","data","setData","navigate","useNavigate","hasMore","setHasMore","promotionListApi","page","res","val","onRefresh","className","text","map","item","index","onClick","status","state","replace","Toast","content","handleViewDetail","title","sub_title","start_time","end_time","e","stopPropagation","handleViewPrize","loadMore"],"sourceRoot":""}
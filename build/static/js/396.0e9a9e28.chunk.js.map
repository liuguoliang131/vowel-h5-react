{"version":3,"file":"static/js/396.0e9a9e28.chunk.js","mappings":"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","sources":["pages/myCourse/index.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport Crumbs1 from '../../components/crumbs1'\r\nimport { PullToRefresh, InfiniteScroll } from 'antd-mobile'\r\nimport { useLocation } from 'react-router-dom'\r\n// import { sleep } from 'antd-mobile/es/utils/sleep'\r\nimport { mockRequest } from './mock-request.jsx'\r\nimport './index.scss'\r\nimport { courseLessonListApi } from '../../axios/api'\r\nimport utils from '../../utils'\r\nfunction MyCourse () {\r\n  const location = useLocation()\r\n  const [currentPage, setCurrentPage] = useState(1)\r\n  const [list] = useState([\r\n\r\n  ])\r\n  const [dataTime, setDataTime] = useState({\r\n    expiration_time: '',\r\n    push_award_time: ''\r\n  })\r\n\r\n  // 播放按钮\r\n  const handlePauseOthter = (index, e) => {\r\n    console.log(index, e)\r\n    const videoDomList = document.getElementsByTagName('video')\r\n    console.log('videoDomList', videoDomList)\r\n    for (let i = 0; i < videoDomList.length; i++) {\r\n      const item = videoDomList[i]\r\n      if (index !== i) {\r\n        item.pause()\r\n      }\r\n    }\r\n  }\r\n  const hashParams = utils.getHashQuery()\r\n  const [data, setData] = useState([])\r\n  const [hasMore, setHasMore] = useState(true)\r\n  async function loadMore () {\r\n    try {\r\n      const res = await courseLessonListApi({\r\n        course_id: location.state.course_id || hashParams.query.course_id,\r\n        page: currentPage\r\n      })\r\n      setCurrentPage(val => val + 1)\r\n      if (res.code !== 0) {\r\n        setHasMore(false)\r\n      }\r\n      if (!res.data || !res.data.list || !res.data.list.length) {\r\n        setHasMore(false)\r\n      } else {\r\n        setData(val => [...val, ...res.data.list])\r\n        const startTime = utils.getTimeData(res.data.expiration_time * 1000)\r\n        const endTime = utils.getTimeData(res.data.push_award_time * 1000)\r\n        const expiration_time = `${startTime.y}.${startTime.mon}.${startTime.dd} ${startTime.hh}:${startTime.MM}:${startTime.ss}`\r\n        const push_award_time = `${endTime.y}.${endTime.mon}.${endTime.dd} ${endTime.hh}:${endTime.MM}:${endTime.ss}`\r\n        setDataTime({\r\n          expiration_time,\r\n          push_award_time\r\n        })\r\n        setHasMore(res.data.list.length > 0)\r\n      }\r\n    } catch (error) {\r\n      setHasMore(false)\r\n      throw error\r\n    }\r\n    // const append = await mockRequest([\r\n    //   { name: '第一课', id: 1 },\r\n    //   { name: '第二课', id: 2 },\r\n    //   { name: '第三课', id: 3 }\r\n    // ])\r\n    // setData(val => [...val, ...append])\r\n    // setHasMore(append.length > 0)\r\n  }\r\n\r\n  // 下拉刷新\r\n  const onRefresh = async () => {\r\n    try {\r\n      setCurrentPage(1)\r\n      const res = await courseLessonListApi({\r\n        course_id: location.state.course_id || hashParams.query.course_id,\r\n        page: 1\r\n      })\r\n      setCurrentPage(val => val + 1)\r\n      console.log('res', res)\r\n      if (!res.data || !res.data.list || !res.data.list.length) {\r\n        setData([])\r\n        setHasMore(false)\r\n      } else {\r\n        setDataTime({\r\n          expiration_time: res.data.expiration_time,\r\n          push_award_time: res.data.push_award_time\r\n        })\r\n        setData(val => [...res.data.list])\r\n        setHasMore(res.data.list.length > 0)\r\n      }\r\n    } catch (error) {\r\n      setHasMore(false)\r\n      throw error\r\n    }\r\n  }\r\n  return (\r\n    <div className='MyCourse'>\r\n      {/* <Crumbs1 text=\"我的课程\"></Crumbs1> */}\r\n      <PullToRefresh\r\n        onRefresh={() => onRefresh()}\r\n      >\r\n        <div className=\"list\">\r\n          <div className=\"scroll-box\">\r\n            {\r\n              data.map((item, index) => (\r\n                <div className=\"item\" key={index}>\r\n                  <div className=\"item-title\">{item.title}</div>\r\n                  <div className=\"item-video\">\r\n                    <video controls controlslist=\"nodownload noremoteplayback\"\r\n                      poster={item.img_url}\r\n                      disablePictureInPicture\r\n                      onPlay={(e) => handlePauseOthter(index, e)}>\r\n                      <source src={item.video_url} type=\"video/mp4\" />\r\n                    </video>\r\n                  </div>\r\n                </div>\r\n              ))\r\n            }\r\n          </div>\r\n          {\r\n            dataTime.expiration_time\r\n              ? (\r\n              <div className=\"footer\">\r\n            <div className=\"footer-content\">\r\n              <div>提示：本次课程的有效期为</div>\r\n              <div>{dataTime.push_award_time}-{dataTime.expiration_time}</div>\r\n            </div>\r\n          </div>\r\n                )\r\n              : null\r\n          }\r\n\r\n          <InfiniteScroll loadMore={loadMore} hasMore={hasMore} />\r\n        </div>\r\n        </PullToRefresh>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default MyCourse\r\n"],"names":["location","useLocation","useState","currentPage","setCurrentPage","expiration_time","push_award_time","dataTime","setDataTime","hashParams","utils","data","setData","hasMore","setHasMore","courseLessonListApi","course_id","state","query","page","res","val","code","list","length","startTime","endTime","y","mon","dd","hh","MM","ss","onRefresh","console","log","className","map","item","index","title","controls","controlslist","poster","img_url","disablePictureInPicture","onPlay","e","videoDomList","document","getElementsByTagName","i","pause","handlePauseOthter","src","video_url","type","loadMore"],"sourceRoot":""}